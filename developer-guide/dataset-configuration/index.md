---
title: Dataset Configuration
order: 90
---

## Schema

See https://github.com/pozi/PoziApp/blob/master/app/src/ConfigManager/schemas/layer-schema.json

## Dataset Types

```
GeoJSON
Image
ImageWMS
QGISGetProjectSettings
Search
TileWMS
TileWMSAuth
Mapbox
Mapbox-GL
Mapbox-OLSM
VectorTile
Vicmap
WFSGetCapabilities
WMSGetCapabilities
XYZ
```

## Standard Layers

* `"title":` use plural name where practical
* `"group":` the name of the layer group in which the layer will appear in the layer panel

## Child Datasets

* `"title":` use singular name where practical
* `"showInLayerControl":` set to `false` to prevent dataset from being listed in the layer panel.
* `"group":` leave blank or undefined

### Spatial Intersection

When a dataset is configured with the `"pointOnSurface": true` transformer function, Pozi filters the dataset to only those records that intersect with the parent geometry.

```json
  "config": {
    "transformer": {
      "pointOnSurface": true
    }
  }
```

## *What's Here* Datasets

*What's Here* is a special case of a child dataset whose "parent" is the geometry generated by the user's map click (or polygon drawn from the `Select by region` tool).

```json
  "parent": "Whats Here",
```

Notes:

* the `"Whats Here"` value in the config does NOT contain an apostrophe
* setting the parent to "Whats Here" is also currently used as a hack for WMS layers to force the results of any `GetFeatureInfo` request to appear in the info panel (however there is [a plan](https://trello.com/c/NuPIDgSL/18-enable-wms-layers-getfeatureinfo-results-to-be-displayed-in-info-panel-by-default) to avoid the need for this hack)

### Static Datasets

If the dataset is a static GeoJSON, the configuration requires the `"pointOnSurface": true` transformer function.

*To do: add example*

### Dynamic Datasets

If the dataset is an API source such as WFS, CKAN or Street View, the request URL needs to include parameter(s) which describes the What's Here geometry:
* `$cqlgeometry`
* `$wkt`
* `$esriGeometry` & `$esriGeometryType`
* `$longitude` & `$latitude`

A complete list of geometry parameters is available [here](https://github.com/pozi/PoziApp/blob/feature-config-manager-improvements/app/src/map/GetGeometryProperties.js#L66-L80).

*To do: add example*

## Examples

### Basic GeoJSON Layer

```json
{
  "title": "Maternal and Child Health Zones",
  "group": "Family Services",
  "type": "GeoJSON",
  "config": {
    "spatial": {
      "url": "https://d2nozjvesbm579.cloudfront.net/ogr2ogr?source=data.gov.au/bendigo/cogb-community-mach-zones.shz",
      "label": "Name",
      "id": "Name"
    }
  },
  "styleGeoStyler": {
    "type": "SLD",
    "url": "https://config.pozi.com/public/files/cogb_mach_zones.sld"
  },
  "opacity": 0.8,
  "queryable": true,
  "showInLayerControl": true
}
```

### Options

#### Queryable

Control whether the features in this layer are queryable/selectable by the user clicking in the map.

```json
  "queryable": true,
```

#### Opacity

```json
  "opacity": 0.7,
```

#### Metadata

```json
  "about": {
    "source": "National Public Toilet Map",
    "organisation": "Australian Department of Health",
    "url": "https://data.gov.au/dataset/ds-dga-553b3049-2b8b-46a2-95e6-640d7986a8c1"
  },
```

#### Zoom Levels

```json
  "minZoom": 16,
  "maxResolution": 4
```

#### Include Fields

```json
  "config": {
    "spatial": {
      "include": [
        "ADD_EZI_ADDRESS",
        "PROP_PROPNUM",
        "PROP_STATUS",
        "PLANNING PROPERTY REPORT"
      ]
    }
  }
```
#### Exclude Fields

Attributes from the source data can be hidden from the info panel display by specifying the fields in an `exclude` array, nested under the `spatial` setting.

```json
  "config": {
    "spatial": {
      "exclude": [
        "type",
        "subtype"
      ]
    }
  }
```

#### Transformers

##### Rename and Order Fields

```json
    "transformer": {
      "renameAndOrderFields": [
        {
          "wetland_no": "Wetland Number"
        },
        {
          "name_main": "Name"
        },
        {
          "name_alt": "Name (Alternate)"
        },
```

#### Promote Details

Display the feature's attributes (which would normally be displayed in the Details panel of the child record) directly in within the parent, taking the place of the child title.

```json
  "promoteDetails": true
```

Only to be used when there is no requirement to view Location/Dimensions, Source or any child records.

#### Link-Out

##### Web Application

```json
  "externalLinks": [
    {
      "url": "http://communityhub.loddon.vic.gov.au/public/processExternalAction.aspx?element=assessmentid&source=pozi&id=[identifiers]",
      "label": "Send to Open Office",
      "propertyName": "Property Number",
      "localDataSource": true
    }
  ],
```

##### Windows Application via URL Protocol

```json
  "externalLinks": [
    {
      "url": "gclaunch://action=PropertyGov&open=true&fid=[identifiers]&rnd=1611116478",
      "label": "Open in Property.Gov",
      "propertyName": "Property Number",
      "localDataSource": true
    }
  ],
```
