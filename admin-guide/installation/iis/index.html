<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-74NZKRQ3KQ"></script>
    <script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-74NZKRQ3KQ');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="2.4.0.784348056675">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 2.4.0">

    <!-- Primary Meta Tags -->
    <title>IIS | Pozi Web GIS | Online Map</title>
    <meta name="title" content="IIS | Pozi Web GIS | Online Map">
    <meta name="description" content="When copying and pasting multiple lines into the command prompt, all lines will be executed except the last one. You must hit" />

    <!-- Canonical -->
    <link rel="canonical" href="https://pozi.com/admin-guide/installation/iis/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pozi.com/admin-guide/installation/iis/">
    <meta property="og:title" content="IIS | Pozi Web GIS | Online Map">
    <meta property="og:description" content="When copying and pasting multiple lines into the command prompt, all lines will be executed except the last one. You must hit">
    <meta property="og:image" content="https://pozi.com/admin-guide/installation/img/pozi-qgis-server-iis.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://pozi.com/admin-guide/installation/iis/">
    <meta property="twitter:title" content="IIS | Pozi Web GIS | Online Map">
    <meta property="twitter:description" content="When copying and pasting multiple lines into the command prompt, all lines will be executed except the last one. You must hit">
    <meta property="twitter:image" content="https://pozi.com/admin-guide/installation/img/pozi-qgis-server-iis.png">

    <script>(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../resources/css/retype.css?v=2.4.0.784348056675" rel="stylesheet" />

    <script type="text/javascript" src="../../../resources/js/config.js?v=2.4.0.784348056675" data-turbo-eval="false" defer></script>
    <script type="text/javascript" src="../../../resources/js/retype.js?v=2.4.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" type="text/javascript" src="../../../resources/js/lunr.js?v=2.4.0.784348056675" data-turbo-eval="false" defer></script>
    <script id="prism-js" type="text/javascript" src="../../../resources/js/prism.js?v=2.4.0.784348056675" defer></script>

    <!-- <script src="https://cdn.tailwindcss.com"></script> -->

    <!-- CSS overrides -->
    <link href="/static/css/retype-pozi.css" rel="stylesheet" />

</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between grow pr-6 md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../" class="flex items-center leading-snug text-2xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../static/img/logo.svg">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../static/img/logo.svg">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Pozi</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path fill-rule="evenodd" d="M11.03 2.59a1.5 1.5 0 011.94 0l7.5 6.363a1.5 1.5 0 01.53 1.144V19.5a1.5 1.5 0 01-1.5 1.5h-5.75a.75.75 0 01-.75-.75V14h-2v6.25a.75.75 0 01-.75.75H4.5A1.5 1.5 0 013 19.5v-9.403c0-.44.194-.859.53-1.144l7.5-6.363zM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75v6.25h5v-9.403L12 3.734z"/>
                                        </g>
                                    </svg>
                                    <span>Home</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../product/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 011.874 0l8.383 5.316a1.75 1.75 0 010 2.956l-8.383 5.316a1.75 1.75 0 01-1.874 0L2.68 9.728a1.75 1.75 0 010-2.956l8.383-5.316zm1.071 1.267a.25.25 0 00-.268 0L3.483 8.039a.25.25 0 000 .422l8.383 5.316a.25.25 0 00.268 0l8.383-5.316a.25.25 0 000-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 011.035-.232l8.964 5.685a.25.25 0 00.268 0l8.964-5.685a.75.75 0 01.804 1.267l-8.965 5.685a1.75 1.75 0 01-1.874 0l-8.965-5.685a.75.75 0 01-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 011.035-.232l8.964 5.685a.25.25 0 00.268 0l8.964-5.685a.75.75 0 01.804 1.267l-8.965 5.685a1.75 1.75 0 01-1.874 0l-8.965-5.685a.75.75 0 01-.231-1.035z"/>
                                        </g>
                                    </svg>
                                    <span>Product</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../help/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path fill-rule="evenodd" d="M1.75 1A1.75 1.75 0 000 2.75v9.5C0 13.216.784 14 1.75 14H3v1.543a1.457 1.457 0 002.487 1.03L8.061 14h6.189A1.75 1.75 0 0016 12.25v-9.5A1.75 1.75 0 0014.25 1H1.75zM1.5 2.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v9.5a.25.25 0 01-.25.25h-6.5a.75.75 0 00-.53.22L4.5 15.44v-2.19a.75.75 0 00-.75-.75h-2a.25.25 0 01-.25-.25v-9.5z"/><path d="M22.5 8.75a.25.25 0 00-.25-.25h-3.5a.75.75 0 010-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0122.25 20H21v1.543a1.457 1.457 0 01-2.487 1.03L15.939 20H10.75A1.75 1.75 0 019 18.25v-1.465a.75.75 0 011.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 01.53.22l2.72 2.72v-2.19a.75.75 0 01.75-.75h2a.25.25 0 00.25-.25v-9.5z"/>
                                        </g>
                                    </svg>
                                    <span>Help</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../blog/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M20.485 2.515a.75.75 0 00-1.06 1.06A10.465 10.465 0 0122.5 11c0 2.9-1.174 5.523-3.075 7.424a.75.75 0 001.06 1.061A11.965 11.965 0 0024 11c0-3.314-1.344-6.315-3.515-8.485zm-15.91 1.06a.75.75 0 00-1.06-1.06A11.965 11.965 0 000 11c0 3.313 1.344 6.314 3.515 8.485a.75.75 0 001.06-1.06A10.465 10.465 0 011.5 11c0-2.9 1.174-5.524 3.075-7.425zM8.11 7.11a.75.75 0 00-1.06-1.06A6.98 6.98 0 005 11a6.98 6.98 0 002.05 4.95.75.75 0 001.06-1.061 5.48 5.48 0 01-1.61-3.89 5.48 5.48 0 011.61-3.888zm8.84-1.06a.75.75 0 10-1.06 1.06A5.48 5.48 0 0117.5 11a5.48 5.48 0 01-1.61 3.889.75.75 0 101.06 1.06A6.98 6.98 0 0019 11a6.98 6.98 0 00-2.05-4.949zM14 11a2 2 0 01-1.25 1.855v8.395a.75.75 0 01-1.5 0v-8.395A2 2 0 1114 11z"/>
                                        </g>
                                    </svg>
                                    <span>Blog</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../about/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M6.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM5.5 9.25a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM6.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 12.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zm.75-4.25a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 5.75A.75.75 0 019.75 5h.5a.75.75 0 010 1.5h-.5A.75.75 0 019 5.75zM13.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zm-.75-2.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM13.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5z"/><path fill-rule="evenodd" d="M2 20a2 2 0 002 2h3.75a.75.75 0 00.75-.75V19h3v2.25c0 .414.336.75.75.75H16c.092 0 .183-.006.272-.018a.753.753 0 00.166.018H20a2 2 0 002-2v-8a2 2 0 00-.8-1.6l-.5-.375a.75.75 0 00-.9 1.2l.5.375a.5.5 0 01.2.4v8a.5.5 0 01-.5.5h-2.063c.041-.16.063-.327.063-.5V3a2 2 0 00-2-2H4a2 2 0 00-2 2v17zm2 .5a.5.5 0 01-.5-.5V3a.5.5 0 01.5-.5h12a.5.5 0 01.5.5v17a.5.5 0 01-.5.5h-3v-2.25a.75.75 0 00-.75-.75h-4.5a.75.75 0 00-.75.75v2.25H4z"/>
                                        </g>
                                    </svg>
                                    <span>About</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../contact/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path fill-rule="evenodd" d="M20.226 7.25a9.498 9.498 0 10-3.477 12.976.75.75 0 01.75 1.299c-5.26 3.037-11.987 1.235-15.024-4.026C-.562 12.24 1.24 5.512 6.501 2.475 11.76-.562 18.488 1.24 21.525 6.501a10.956 10.956 0 011.455 4.826c.013.056.02.113.02.173v2.25a3.5 3.5 0 01-6.623 1.581 5.5 5.5 0 111.112-3.682.76.76 0 01.011.129v1.972a2 2 0 104 0v-1.766a9.452 9.452 0 00-1.274-4.733zM16 12a4 4 0 10-8 0 4 4 0 008 0z"/>
                                        </g>
                                    </svg>
                                    <span>Contact</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
        
                            <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                            style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                        </div>
        
                        <!-- Mobile search button mock -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placehokder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button mock -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
                </div>
            
                <div class="pl-6 mb-4 mt-1">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path fill-rule="evenodd" d="M11.03 2.59a1.5 1.5 0 011.94 0l7.5 6.363a1.5 1.5 0 01.53 1.144V19.5a1.5 1.5 0 01-1.5 1.5h-5.75a.75.75 0 01-.75-.75V14h-2v6.25a.75.75 0 01-.75.75H4.5A1.5 1.5 0 013 19.5v-9.403c0-.44.194-.859.53-1.144l7.5-6.363zM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75v6.25h5v-9.403L12 3.734z"/>
                                                </g>
                                            </svg>
                                            <span>Home</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../product/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 011.874 0l8.383 5.316a1.75 1.75 0 010 2.956l-8.383 5.316a1.75 1.75 0 01-1.874 0L2.68 9.728a1.75 1.75 0 010-2.956l8.383-5.316zm1.071 1.267a.25.25 0 00-.268 0L3.483 8.039a.25.25 0 000 .422l8.383 5.316a.25.25 0 00.268 0l8.383-5.316a.25.25 0 000-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 011.035-.232l8.964 5.685a.25.25 0 00.268 0l8.964-5.685a.75.75 0 01.804 1.267l-8.965 5.685a1.75 1.75 0 01-1.874 0l-8.965-5.685a.75.75 0 01-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 011.035-.232l8.964 5.685a.25.25 0 00.268 0l8.964-5.685a.75.75 0 01.804 1.267l-8.965 5.685a1.75 1.75 0 01-1.874 0l-8.965-5.685a.75.75 0 01-.231-1.035z"/>
                                                </g>
                                            </svg>
                                            <span>Product</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../help/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path fill-rule="evenodd" d="M1.75 1A1.75 1.75 0 000 2.75v9.5C0 13.216.784 14 1.75 14H3v1.543a1.457 1.457 0 002.487 1.03L8.061 14h6.189A1.75 1.75 0 0016 12.25v-9.5A1.75 1.75 0 0014.25 1H1.75zM1.5 2.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v9.5a.25.25 0 01-.25.25h-6.5a.75.75 0 00-.53.22L4.5 15.44v-2.19a.75.75 0 00-.75-.75h-2a.25.25 0 01-.25-.25v-9.5z"/><path d="M22.5 8.75a.25.25 0 00-.25-.25h-3.5a.75.75 0 010-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0122.25 20H21v1.543a1.457 1.457 0 01-2.487 1.03L15.939 20H10.75A1.75 1.75 0 019 18.25v-1.465a.75.75 0 011.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 01.53.22l2.72 2.72v-2.19a.75.75 0 01.75-.75h2a.25.25 0 00.25-.25v-9.5z"/>
                                                </g>
                                            </svg>
                                            <span>Help</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../blog/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M20.485 2.515a.75.75 0 00-1.06 1.06A10.465 10.465 0 0122.5 11c0 2.9-1.174 5.523-3.075 7.424a.75.75 0 001.06 1.061A11.965 11.965 0 0024 11c0-3.314-1.344-6.315-3.515-8.485zm-15.91 1.06a.75.75 0 00-1.06-1.06A11.965 11.965 0 000 11c0 3.313 1.344 6.314 3.515 8.485a.75.75 0 001.06-1.06A10.465 10.465 0 011.5 11c0-2.9 1.174-5.524 3.075-7.425zM8.11 7.11a.75.75 0 00-1.06-1.06A6.98 6.98 0 005 11a6.98 6.98 0 002.05 4.95.75.75 0 001.06-1.061 5.48 5.48 0 01-1.61-3.89 5.48 5.48 0 011.61-3.888zm8.84-1.06a.75.75 0 10-1.06 1.06A5.48 5.48 0 0117.5 11a5.48 5.48 0 01-1.61 3.889.75.75 0 101.06 1.06A6.98 6.98 0 0019 11a6.98 6.98 0 00-2.05-4.949zM14 11a2 2 0 01-1.25 1.855v8.395a.75.75 0 01-1.5 0v-8.395A2 2 0 1114 11z"/>
                                                </g>
                                            </svg>
                                            <span>Blog</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../about/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M6.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM5.5 9.25a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM6.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 12.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zm.75-4.25a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 5.75A.75.75 0 019.75 5h.5a.75.75 0 010 1.5h-.5A.75.75 0 019 5.75zM13.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zm-.75-2.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM13.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5z"/><path fill-rule="evenodd" d="M2 20a2 2 0 002 2h3.75a.75.75 0 00.75-.75V19h3v2.25c0 .414.336.75.75.75H16c.092 0 .183-.006.272-.018a.753.753 0 00.166.018H20a2 2 0 002-2v-8a2 2 0 00-.8-1.6l-.5-.375a.75.75 0 00-.9 1.2l.5.375a.5.5 0 01.2.4v8a.5.5 0 01-.5.5h-2.063c.041-.16.063-.327.063-.5V3a2 2 0 00-2-2H4a2 2 0 00-2 2v17zm2 .5a.5.5 0 01-.5-.5V3a.5.5 0 01.5-.5h12a.5.5 0 01.5.5v17a.5.5 0 01-.5.5h-3v-2.25a.75.75 0 00-.75-.75h-4.5a.75.75 0 00-.75.75v2.25H4z"/>
                                                </g>
                                            </svg>
                                            <span>About</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="../../../contact/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path fill-rule="evenodd" d="M20.226 7.25a9.498 9.498 0 10-3.477 12.976.75.75 0 01.75 1.299c-5.26 3.037-11.987 1.235-15.024-4.026C-.562 12.24 1.24 5.512 6.501 2.475 11.76-.562 18.488 1.24 21.525 6.501a10.956 10.956 0 011.455 4.826c.013.056.02.113.02.173v2.25a3.5 3.5 0 01-6.623 1.581 5.5 5.5 0 111.112-3.682.76.76 0 01.011.129v1.972a2 2 0 104 0v-1.766a9.452 9.452 0 00-1.274-4.733zM16 12a4 4 0 10-8 0 4 4 0 008 0z"/>
                                                </g>
                                            </svg>
                                            <span>Contact</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="grow min-w-0 px-6 md:px-16">
                        <main class="relative pt-6 pb-16">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                
                                <!-- Page content  -->
<doc-anchor-target id="iis" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#iis">#</doc-anchor-trigger>
        <span>IIS</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="install-iis">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#install-iis">#</doc-anchor-trigger>
        <span>Install IIS</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-gray-500 dark:bg-dark-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-gray-500 dark:text-dark-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Copying and pasting using command prompt</h5>
<p>When copying and pasting multiple lines into the command prompt, all lines will be executed except the last one. You must hit <code v-pre>Enter</code> for the last line to be executed.</p>
        </div>
    </div>
</div>
<p>In a new command prompt window, running as administrator:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">dism /online /enable-feature /featurename:IIS-WebServerRole
dism /online /enable-feature /featurename:IIS-WebServer
dism /online /enable-feature /featurename:IIS-ApplicationDevelopment
dism /online /enable-feature /featurename:IIS-ApplicationInit
dism /Online /Enable-Feature /FeatureName:IIS-CGI
</code></pre>
</doc-codeblock></div>
<p>If IIS has not previously been set up on the server, the command prompt may return <code v-pre>Restart Windows to complete this operation</code>.  Restarting may be necessary for the subsequent configuration.</p>
<doc-anchor-target id="create-backup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#create-backup">#</doc-anchor-trigger>
        <span>Create backup</span>
    </h2>
</doc-anchor-target>
<p>Before continuing or making any changes in the future, it may be a good idea to create a backup.</p>
<p>Execute the following command for creating a backup:</p>
<p>&#x27;&#x27;&#x27;
&quot;%systemroot%\system32\inetsrv\appcmd&quot; add backup
&#x27;&#x27;&#x27;</p>
<p>The most relevant files are:</p>
<p><code v-pre>%windir%\System32\inetsrv\config\applicationHost.config</code></p>
<p>and</p>
<p><code v-pre>C:\Pozi\IIS\QgisServer\web.config</code></p>
<p>It may be worth creating a manual backup of these files too, in order to see what changes have been made to these files.</p>
<doc-anchor-target id="prepare-folders">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#prepare-folders">#</doc-anchor-trigger>
        <span>Prepare Folders</span>
    </h2>
</doc-anchor-target>
<ul>
<li>create folder path: <code v-pre>C:\Pozi\IIS\QgisServer</code></li>
<li>create <code v-pre>web.config</code> file at this location with the following content</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\Pozi\IIS\QgisServer\web.config</div>
<pre class="language-markup"><code v-pre class="language-markup">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
    &lt;system.webServer&gt;
        &lt;handlers&gt;
            &lt;add name=&quot;PoziQgisServerFastCgi&quot; path=&quot;*&quot; verb=&quot;*&quot; type=&quot;&quot; modules=&quot;FastCgiModule&quot; scriptProcessor=&quot;C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe&quot;
            resourceType=&quot;Unspecified&quot; requireAccess=&quot;Script&quot; allowPathInfo=&quot;false&quot; preCondition=&quot;&quot; responseBufferLimit=&quot;4000000000&quot; /&gt;
        &lt;/handlers&gt;
        &lt;security&gt;
            &lt;requestFiltering&gt;
                &lt;requestLimits maxQueryString=&quot;32768&quot;/&gt;
            &lt;/requestFiltering&gt;
        &lt;/security&gt;
        &lt;caching enabled=&quot;true&quot; enableKernelCache=&quot;true&quot; /&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;</code></pre>
</doc-codeblock></div>
<p>NOTE: If you have installed QGIS Server to a location other than the default <code v-pre>C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe</code> then you will need to update that path in the <code v-pre>web.config</code> file. You&#x27;ll also need to make the necessary substitutions in many of the commands below.</p>
<doc-anchor-target id="background-information">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#background-information">#</doc-anchor-trigger>
        <span>Background information:</span>
    </h3>
</doc-anchor-target>
<ul>
<li><a href="https://learn.microsoft.com/en-us/iis/configuration/system.webserver/fastcgi/">FastCGI</a></li>
</ul>
<doc-anchor-target id="configure-iis">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#configure-iis">#</doc-anchor-trigger>
        <span>Configure IIS</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">&quot;%systemroot%\system32\inetsrv\appcmd&quot; add app /site.name:&quot;Default Web Site&quot; /path:/Pozi /physicalPath:&quot;C:\Pozi\IIS&quot;
&quot;%systemroot%\system32\inetsrv\appcmd&quot; add app /site.name:&quot;Default Web Site&quot; /path:/Pozi/QgisServer /physicalPath:&quot;C:\Pozi\IIS\QgisServer&quot;
</code></pre>
</doc-codeblock></div>
<p>If the command prompt returns <code v-pre>&quot;C:\Windows\system32\inetsrv\appcmd&quot; is not recognised as an internal or external command</code>, then a restart may be required before re-attempting this configuration step.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">%windir%\system32\inetsrv\appcmd.exe unlock config -section:system.webServer/handlers

&quot;%systemroot%\system32\inetsrv\appcmd&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe',idleTimeout='604800',maxInstances='5',activityTimeout='70',requestTimeout='120']&quot; /commit:apphost

&quot;%systemroot%\system32\inetsrv\appcmd&quot; set config /section:isapiCgiRestriction /+&quot;[path='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe',description='PoziQgisServer',allowed='True']&quot;</code></pre>
</doc-codeblock></div>
<p><strong>Tip</strong>: if a fastCGI request frequently times out due to a slow database connection or very large datasets, change the <code v-pre>requestTimeout</code> value to a greater number (in seconds).</p>
<doc-anchor-target id="configure-environment-variables">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#configure-environment-variables">#</doc-anchor-trigger>
        <span>Configure Environment Variables</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-yellow-500"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-yellow-500" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M22.48 15.59L14.01 1.45A2.968 2.968 0 0012.16.09c-.78-.19-1.58-.07-2.27.35-.41.25-.76.6-1.01 1.01v.01L.4 15.6c-.83 1.43-.33 3.27 1.1 4.1.45.26.95.4 1.48.4h16.95c.8-.01 1.55-.33 2.11-.9.56-.57.87-1.33.86-2.13a3.04 3.04 0 00-.42-1.48zm-1.87 2.21c-.19.19-.44.3-.69.3H2.99c-.17 0-.34-.05-.49-.13a.992.992 0 01-.37-1.35L10.6 2.48c.08-.14.2-.25.34-.33a.992.992 0 011.37.33l8.46 14.13c.09.15.13.32.13.49 0 .26-.1.51-.29.7z"></path>
                    <path d="M11.45 12.1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 .56.45 1 1 1zM11.46 14.1c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>As of April 2023, the OSGeo4W installer installs Python in <code v-pre>C:\OSGeo4W\apps\Python312</code>. The below scripts have been updated to use this new location. Any Pozi installations prior to April 2023 have the environment variables configured to use <code v-pre>C:\OSGeo4W\apps\Python39</code>. Beware of any potential conflicts when upgrading an existing installation.</p>
        </div>
    </div>
</div>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-yellow-500"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-yellow-500" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M22.48 15.59L14.01 1.45A2.968 2.968 0 0012.16.09c-.78-.19-1.58-.07-2.27.35-.41.25-.76.6-1.01 1.01v.01L.4 15.6c-.83 1.43-.33 3.27 1.1 4.1.45.26.95.4 1.48.4h16.95c.8-.01 1.55-.33 2.11-.9.56-.57.87-1.33.86-2.13a3.04 3.04 0 00-.42-1.48zm-1.87 2.21c-.19.19-.44.3-.69.3H2.99c-.17 0-.34-.05-.49-.13a.992.992 0 01-.37-1.35L10.6 2.48c.08-.14.2-.25.34-.33a.992.992 0 011.37.33l8.46 14.13c.09.15.13.32.13.49 0 .26-.1.51-.29.7z"></path>
                    <path d="M11.45 12.1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 .56.45 1 1 1zM11.46 14.1c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>Any Pozi installations prior to November 2024 will need to add the environment variable <code v-pre>QT_QPA_FONTDIR</code> with the setting <code v-pre>C:\Windows\Fonts</code> (being the location fonts are installed on the server). This enables the use of fonts, besides traditional web-safe fonts, for points and labelling in WMS layers.  This setting has now been included in the instructions below.</p>
        </div>
    </div>
</div>
<doc-tabs>
<doc-tab id="command-prompt">
<template #title>Command Prompt</template>
<p>Copy and paste the following into the command prompt:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">:: Clear any potentially pre-existing env vars (handy when doing upgrades)
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /-&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables

:: Set env vars

:: The PATH variable required
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='PATH',value='C:\OSGeo4W\apps\qgis-ltr\bin;C:\OSGeo4W\apps\qt5\bin;C:\OSGeo4W\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32\WBem']&quot; /commit:apphost

:: The following env vars may be optional
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_PREFIX',value='C:\OSGeo4W\apps\Qt5']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_BINARIES',value='C:\OSGeo4W\apps\Qt5\bin']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_PLUGINS',value='C:\OSGeo4W\apps\Qt5\plugins']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_LIBRARIES',value='C:\OSGeo4W\apps\Qt5\lib']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_TRANSLATIONS',value='C:\OSGeo4W\apps\Qt5\translations']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='O4W_QT_HEADERS',value='C:\OSGeo4W\apps\Qt5\include']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QGIS_PREFIX_PATH',value='C:\OSGeo4W\apps\qgis-ltr']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QT_PLUGIN_PATH',value='C:\OSGeo4W\apps\qt5\plugins']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='TEMP',value='C:\Windows\Temp']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='PYTHONHOME',value='C:\OSGeo4W\apps\Python312']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QGIS_SERVER_IGNORE_BAD_LAYERS',value='1']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QGIS_SERVER_LOG_FILE',value='C:\Pozi\IIS\QgisServer\qgis_server.log']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QGIS_SERVER_LOG_LEVEL',value='1']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QGIS_PLUGINPATH',value='C:\OSGeo4W\apps\qgis-ltr\plugins']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='GDAL_DRIVER_PATH',value='C:\OSGeo4W\apps\gdal\lib\gdalplugins']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='GDAL_DATA',value='C:\OSGeo4W\apps\gdal\share\gdal']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='PYTHONPATH',value='C:\OSGeo4W\apps\qgis-ltr\python']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='PROJ_LIB',value='C:\OSGeo4W\share\proj']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='DEBUG_WFSOUTPUTEXTENSION',value='1']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/fastCgi /+&quot;[fullPath='C:\OSGeo4W\apps\qgis-ltr\bin\qgis_mapserv.fcgi.exe'].environmentVariables.[name='QT_QPA_FONTDIR',value='C:\Windows\Fonts']&quot; /commit:apphost
</code></pre>
</doc-codeblock></div>
</doc-tab>
<doc-tab id="manual-configuration">
<template #title>Manual Configuration</template>
<p>If the command prompt option doesn&#x27;t work, you can configure the environment variables manually.</p>
<p><figure class="content-center">
    <img src="../img/pozi-qgis-server-iis.png" alt="FastCGI Settings" />
    <figcaption class="caption">FastCGI Settings</figcaption>
</figure>
</p>
<p>Windows &gt; IIS &gt; select server &gt; Fast CGISettings &gt; select <code v-pre>qgis_mapserv.fcgi.exe</code> application &gt; Edit &gt; Environment variables:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>PATH</td>
<td><code v-pre>C:\OSGeo4W\apps\qgis-ltr\bin;C:\OSGeo4W\apps\qt5\bin;C:\OSGeo4W\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32\WBem</code></td>
</tr>
<tr>
<td>O4W_QT_PREFIX</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5</code></td>
</tr>
<tr>
<td>O4W_QT_BINARIES</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5\bin</code></td>
</tr>
<tr>
<td>O4W_QT_PLUGINS</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5\plugins</code></td>
</tr>
<tr>
<td>O4W_QT_LIBRARIES</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5\lib</code></td>
</tr>
<tr>
<td>O4W_QT_TRANSLATIONS</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5\translations</code></td>
</tr>
<tr>
<td>O4W_QT_HEADERS</td>
<td><code v-pre>C:\OSGeo4W\apps\Qt5\include</code></td>
</tr>
<tr>
<td>QGIS_PREFIX_PATH</td>
<td><code v-pre>C:\OSGeo4W\apps\qgis-ltr</code></td>
</tr>
<tr>
<td>QT_PLUGIN_PATH</td>
<td><code v-pre>C:\OSGeo4W\apps\qt5\plugins</code></td>
</tr>
<tr>
<td>TEMP</td>
<td><code v-pre>C:\Windows\Temp</code></td>
</tr>
<tr>
<td>PYTHONHOME</td>
<td><code v-pre>C:\OSGeo4W\apps\Python312</code></td>
</tr>
<tr>
<td>QGIS_SERVER_IGNORE_BAD_LAYERS</td>
<td><code v-pre>1</code></td>
</tr>
<tr>
<td>QGIS_SERVER_LOG_FILE</td>
<td><code v-pre>C:\Pozi\IIS\QgisServer\qgis_server.log</code></td>
</tr>
<tr>
<td>QGIS_SERVER_LOG_LEVEL</td>
<td><code v-pre>1</code></td>
</tr>
<tr>
<td>QGIS_PLUGINPATH</td>
<td><code v-pre>C:\OSGeo4W\apps\qgis-ltr\plugins</code></td>
</tr>
<tr>
<td>GDAL_DRIVER_PATH</td>
<td><code v-pre>C:\OSGeo4W\apps\gdal\lib\gdalplugins</code></td>
</tr>
<tr>
<td>GDAL_DATA</td>
<td><code v-pre>C:\OSGeo4W\apps\gdal\share\gdal</code></td>
</tr>
<tr>
<td>PYTHONPATH</td>
<td><code v-pre>C:\OSGeo4W\apps\qgis-ltr\python</code></td>
</tr>
<tr>
<td>PROJ_LIB</td>
<td><code v-pre>C:\OSGeo4W\share\proj</code></td>
</tr>
<tr>
<td>DEBUG_WFSOUTPUTEXTENSION</td>
<td><code v-pre>1</code></td>
</tr>
<tr>
<td>QT_QPA_FONTDIR</td>
<td><code v-pre>C:\Windows\Fonts</code></td>
</tr>
</tbody>
</table>
</div>
<p>(End of <code v-pre>Manual Configuration</code> instructions)</p>
</doc-tab>
</doc-tabs>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-blue-500 dark:bg-blue-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-blue-500 dark:text-blue-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Log Levels</h5>
<p>The above script/instructions sets the <code v-pre>QGIS_SERVER_LOG_LEVEL</code> value to <code v-pre>1</code> to capture warnings and critical events in the log. If you want to capture <em>all</em> activity for troubleshooting purposes, set the value to <code v-pre>0</code> in the GUI.</p>
<p>More information about QGIS log levels is at <a href="https://docs.qgis.org/latest/en/docs/server_manual/config.html#qgis-server-log-level">https://docs.qgis.org/latest/en/docs/server_manual/config.html#qgis-server-log-level</a></p>
        </div>
    </div>
</div>
<doc-anchor-target id="application-pool">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#application-pool">#</doc-anchor-trigger>
        <span>Application Pool</span>
    </h2>
</doc-anchor-target>
<p>Create PoziQgisServer application pool:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; add apppool /name:&quot;PoziQgisServer&quot;
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set app &quot;Default Web Site/Pozi/QgisServer&quot; /applicationPool:&quot;PoziQgisServer&quot;
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.applicationHost/applicationPools /+&quot;[name='PoziQgisServer'].recycling.periodicRestart.schedule.[value='02:00:00']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set apppool &quot;PoziQgisServer&quot; /recycling.periodicRestart.time:00:00:00
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set apppool &quot;PoziQgisServer&quot; /processModel.idleTimeout:00:00:00
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set apppool &quot;PoziQgisServer&quot; /startMode:AlwaysRunning
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set app &quot;Default Web Site/Pozi/QgisServer&quot; /preloadEnabled:true
</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="permissions">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#permissions">#</doc-anchor-trigger>
        <span>Permissions</span>
    </h2>
</doc-anchor-target>
<p>Set permissions for <code v-pre>IIS AppPool\PoziQgisServer</code> :</p>
<p>IIS &gt; select server &gt; Application Pools &gt; PoziQgisServer &gt; Advanced settings &gt; Identity &gt; Application Pool Identity &gt; Custom account &gt; enter details of the domain user that runs Pozi &quot;service&quot; account (include the domain prefix and backslash, or use the email address of the domain user)</p>
<doc-anchor-target id="cors">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cors">#</doc-anchor-trigger>
        <span>CORS</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-blue-500 dark:bg-blue-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-blue-500 dark:text-blue-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Note</h5>
<p>This section is applicable to sites that are <em>not</em> utilising MS App Proxy.</p>
        </div>
    </div>
</div>
<p>CORS (cross-origin resource sharing) is a security precaution that stops a website from drawing content across from another domain name. In this case, the QGIS Server needs to allow the organisation&#x27;s Pozi site as a trusted content source.</p>
<p>If your site is not using MS App Proxy, then CORS headers must be set by IIS.</p>
<p>IIS &gt; select server &gt; Site &gt; Default Web Site &gt; Pozi &gt; QgisServer:</p>
<ul>
<li>Open feature &#x27;HTTP Response Headers&#x27;</li>
<li>Action &#x27;Add...&#x27;</li>
<li><strong>Name</strong>: <code v-pre>Access-Control-Allow-Origin</code></li>
<li><strong>Value</strong>: <code v-pre>*</code></li>
<li>Action &#x27;Add...&#x27;</li>
<li><strong>Name</strong>: <code v-pre>Access-Control-Allow-Methods</code></li>
<li><strong>Value</strong>: <code v-pre>GET,POST,OPTIONS</code></li>
</ul>
<p>If/when Pozi supports data editing, the <code v-pre>Access-Control-Allow-Methods</code> header can be updated to include <code v-pre>PUT</code> and <code v-pre>DELETE</code>.</p>
<doc-anchor-target id="testing">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#testing">#</doc-anchor-trigger>
        <span>Testing</span>
    </h2>
</doc-anchor-target>
<p>The easiest way to test is by pointing the browser to:</p>
<p><code v-pre>http://localhost/pozi/qgisserver/wfs3.html</code></p>
<p>This should show a friendly QGIS Server landing page.</p>
<doc-anchor-target id="getprojectsettings">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#getprojectsettings">#</doc-anchor-trigger>
        <span>GetProjectSettings</span>
    </h3>
</doc-anchor-target>
<p>To test if QGIS Server can serve up the WMS GetProjectSettings, create request for a QGIS project file as follows:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">http://localhost/pozi/qgisserver?service=WMS&amp;map=C:/Projects/SomeProject.qgs&amp;request=GetProjectSettings</code></pre>
</doc-codeblock></div>
<p>Substitute <code v-pre>C:/Projects/SomeProject.qgs</code> with the file path of an actual QGIS project file. Any backslashes in the path must be replaced with forward slashes.</p>
<p>Enter the constructed URL into the address bar of your browser, hit Enter, and you should see an XML file that describes the data endpoints for the project&#x27;s layers.</p>
<br/>
<hr />
<doc-anchor-target id="dynamic-compression">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dynamic-compression">#</doc-anchor-trigger>
        <span>Dynamic Compression</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-gray-500 dark:bg-dark-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-gray-500 dark:text-dark-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Under Construction</h5>
<p><em>This section is a work in progress. Please get in touch with us before following any of the steps below</em></p>
        </div>
    </div>
</div>
<p>Enable the Dynamic Compression IIS module:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">dism /online /Enable-Feature /FeatureName:IIS-HttpCompressionDynamic</code></pre>
</doc-codeblock></div>
<p>Configure <code v-pre>applicationHost.config</code>, section <code v-pre>configuration.system.webServer</code> the following way by replacing <code v-pre>&lt;httpCompression /&gt;</code> with:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">%windir%\System32\inetsrv\config\applicationHost.config</div>
<pre class="language-markup"><code v-pre class="language-markup">	    &lt;httpCompression
            doDiskSpaceLimiting=&quot;true&quot;
            maxDiskSpaceUsage=&quot;2000&quot;
            noCompressionForProxies=&quot;false&quot;
            staticCompressionIgnoreHitFrequency=&quot;true&quot;
            dynamicCompressionDisableCpuUsage=&quot;100&quot;
            dynamicCompressionEnableCpuUsage=&quot;100&quot;
            dynamicCompressionBufferLimit=&quot;4255360000&quot;
            cacheControlHeader=&quot;max-age=10&quot;
            sendCacheHeaders=&quot;false&quot;
        &gt;

            &lt;!--
            &lt;scheme name=&quot;br&quot; dll=&quot;%ProgramFiles%\IIS\IIS Compression\iisbrotli.dll&quot; /&gt;
            &lt;scheme name=&quot;gzip&quot; dll=&quot;%ProgramFiles%\IIS\IIS Compression\iiszlib.dll&quot; /&gt;
            --&gt;

            &lt;staticTypes&gt;
				&lt;add mimeType=&quot;*/*spreadsheet*&quot; enabled=&quot;false&quot; /&gt;

				&lt;add mimeType=&quot;*/*xml*&quot; enabled=&quot;true&quot; /&gt;
				&lt;add mimeType=&quot;*/*svg*&quot; enabled=&quot;true&quot; /&gt;

				&lt;add mimeType=&quot;image/*&quot; enabled=&quot;false&quot; /&gt;
				&lt;add mimeType=&quot;*/*zip*&quot; enabled=&quot;false&quot; /&gt;

				&lt;add mimeType=&quot;*/*&quot; enabled=&quot;true&quot; /&gt;
            &lt;/staticTypes&gt;

            &lt;dynamicTypes&gt;
				&lt;add mimeType=&quot;*/*spreadsheet*&quot; enabled=&quot;false&quot; /&gt;

				&lt;add mimeType=&quot;*/*xml*&quot; enabled=&quot;true&quot; /&gt;
				&lt;add mimeType=&quot;*/*svg*&quot; enabled=&quot;true&quot; /&gt;

				&lt;add mimeType=&quot;image/*&quot; enabled=&quot;false&quot; /&gt;
				&lt;add mimeType=&quot;*/*zip*&quot; enabled=&quot;false&quot; /&gt;

				&lt;add mimeType=&quot;*/*&quot; enabled=&quot;true&quot; /&gt;
                &lt;add mimeType=&quot;application/msword&quot; enabled=&quot;true&quot; /&gt;
            &lt;/dynamicTypes&gt;
        &lt;/httpCompression&gt;</code></pre>
</doc-codeblock></div>
<p>The above can be achieved by executing the following commands:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">:: Configure httpCompression settings
:: &quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /directory:&quot;%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /doDiskSpaceLimiting:true /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /maxDiskSpaceUsage:2000 /commit:apphost &amp; :: in megabytes
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /noCompressionForProxies:false  /commit:apphost &amp;:: VERY IMPORTANT, otherwise compression will be disable for Cloudfront/App Proxy
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /staticCompressionIgnoreHitFrequency:true  /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /dynamicCompressionDisableCpuUsage:100 /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /dynamicCompressionEnableCpuUsage:100 /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /dynamicCompressionBufferLimit:4255360000 /commit:apphost &amp;:: VERY IMPORTANT for caching/compressing large results. In bytes.
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /cacheControlHeader:&quot;max-age=60&quot; &amp; :: in seconds
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /sendCacheHeaders:false &amp; :: if true, this will allow for browser side disk caching

:: Add Brotli scheme (should not need to be added)
:: &quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;[name='br',dll='%ProgramFiles%\IIS\IIS Compression\iisbrotli.dll']&quot; /commit:apphost

:: Add Gzip scheme (should not need to be added)
:: &quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;[name='gzip',dll='%ProgramFiles%\IIS\IIS Compression\iiszlib.dll']&quot; /commit:apphost

:: Configure staticTypes
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='*/*spreadsheet*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='*/*xml*',enabled='true']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='*/*svg*',enabled='true']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='image/*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='*/*zip*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;staticTypes.[mimeType='*/*',enabled='true']&quot; /commit:apphost

:: Configure dynamicTypes
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='*/*spreadsheet*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='*/*xml*',enabled='true']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='*/*svg*',enabled='true']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='image/*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='*/*zip*',enabled='false']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='*/*',enabled='true']&quot; /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/httpCompression /+&quot;dynamicTypes.[mimeType='application/msword',enabled='True']&quot; /commit:apphost

:: Enable urlCompression
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:urlCompression /doStaticCompression:true /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:urlCompression /doDynamicCompression:true /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:urlCompression /dynamicCompressionBeforeCache:true /commit:apphost
</code></pre>
</doc-codeblock></div>
<p>Note:</p>
<ul>
<li><code v-pre>maxDiskSpaceUsage</code>: size is in MB</li>
<li><code v-pre>noCompressionForProxies:false</code>: If this value is set to <code v-pre>true</code>, IIS will not compress if it detects that the request has come through a proxy. Cloudfront and Azure/Entra Id App Proxy
fall in that category, so it&#x27;s important to set this value to <code v-pre>false</code>.</li>
<li><code v-pre>dynamicCompressionBufferLimit</code>: this value (size in bytes) determines the maximum uncompressed response size before deciding not to compress the result. It has been observed in some IIS
instances that when the size gets above 30MB, the response throughput becomes progressively slower as the size increases.</li>
<li><code v-pre>dynamicCompressionBeforeCache:true</code> has a limit of about 15MB uncompressed or 5MB compressed (on a server with 1GB memory). Any response that is bigger than that will disable compression.
If the value is set to <code v-pre>false</code>, the response will always be compressed but not cached (if caching is enabled below). The optimal setting of this depends on
the capabilities of the server that IIS resides on or the speed of the network connection and may need to be assessed on a case by case basis.</li>
<li><code v-pre>cacheControlHeader</code>: <code v-pre>max-age</code> value is in seconds</li>
<li><code v-pre>sendCacheHeaders</code>: if set to true, the browser will cache the contents for up to the value of <code v-pre>max-age</code> in the <code v-pre>cacheControlHeader</code> attribute</li>
</ul>
<p><strong>Also note</strong>: the settings above affect all sites running on IIS. If this is problematic, move the settings to the <code v-pre>C:\Pozi\IIS\QgisServer\web.config</code> file.
It may be necessary to change some settings in <code v-pre>applicationHost.config</code> to allow for this to happen.</p>
<p><strong>TODO: determine if the following is needed:</strong></p>
<p>In <code v-pre>web.config</code>, make sure that the following <code v-pre>responseBufferLimit=&quot;4000000000&quot;</code> is set in the <code v-pre>PoziQgisServerFastCgi</code> handler:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\Pozi\IIS\QgisServer\web.config</div>
<pre class="language-markup"><code v-pre class="language-markup">        &lt;handlers&gt;
            &lt;add name=&quot;PoziQgisServerFastCgi&quot; .... responseBufferLimit=&quot;4000000000&quot; /&gt;</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="caching">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#caching">#</doc-anchor-trigger>
        <span>Caching</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-gray-500 dark:bg-dark-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-gray-500 dark:text-dark-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Under Construction</h5>
<p><em>This section is a work in progress. Please get in touch with us before following any of the steps below</em></p>
        </div>
    </div>
</div>
<p>Enable caching from the first time a document is being requested in section <code v-pre>configuration.system.webServer</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\Pozi\IIS\QgisServer\web.config</div>
<pre class="language-markup"><code v-pre class="language-markup">        &lt;serverRuntime frequentHitThreshold=&quot;1&quot; frequentHitTimePeriod=&quot;00:10:00&quot; /&gt;

        &lt;caching enabled=&quot;true&quot; enableKernelCache=&quot;true&quot; maxCacheSize=&quot;2000&quot; maxResponseSize=&quot;4120000000&quot; /&gt;</code></pre>
</doc-codeblock></div>
<p><strong>Command-line</strong>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/serverRuntime /frequentHitThreshold:1 /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/serverRuntime /frequentHitTimePeriod:&quot;00:10:00&quot; /commit:apphost</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/caching /enabled:true /commit:apphost
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/caching /enableKernelCache:false /commit:apphost &amp; :: set to false to prevent frequent clearing of cache
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/caching /maxCacheSize:2000 /commit:apphost &amp; :: can only be set here (size in megabytes)
&quot;%systemroot%\system32\inetsrv\appcmd.exe&quot; set config -section:system.webServer/caching /maxResponseSize:4120000000 /commit:apphost &amp; :: can only be set here (size in bytes)</code></pre>
</doc-codeblock></div>
<p>Add to the <code v-pre>C:\Pozi\IIS\QgisServer\web.config</code> in section <code v-pre>configuration.system.webServer</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\Pozi\IIS\QgisServer\web.config</div>
<pre class="language-markup"><code v-pre class="language-markup">		&lt;caching enabled=&quot;true&quot; enableKernelCache=&quot;false&quot;&gt;
            &lt;profiles&gt;
                &lt;add extension=&quot;*&quot; policy=&quot;CacheForTimePeriod&quot; kernelCachePolicy=&quot;CacheForTimePeriod&quot; duration=&quot;00:10:00&quot; location=&quot;Any&quot; varyByQueryString=&quot;*&quot; varyByHeaders=&quot;Accept-Encoding&quot; /&gt;
            &lt;/profiles&gt;
        &lt;/caching&gt;</code></pre>
</doc-codeblock></div>
<p><strong>Command-line</strong>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">&quot;%systemroot%\system32\inetsrv\appcmd&quot; set config &quot;Default Web Site/Pozi/QgisServer&quot; -section:system.webServer/caching /enabled:true
&quot;%systemroot%\system32\inetsrv\appcmd&quot; set config &quot;Default Web Site/Pozi/QgisServer&quot; -section:system.webServer/caching /enableKernelCache:false
&quot;%systemroot%\system32\inetsrv\appcmd&quot; set config &quot;Default Web Site/Pozi/QgisServer&quot; -section:system.webServer/caching /+profiles.[extension='*',duration='00:10:00',location='Any',policy='CacheForTimePeriod',kernelCachePolicy='CacheForTimePeriod',varyByQueryString='*',varyByHeaders='Accept-Encoding']</code></pre>
</doc-codeblock></div>
<p>This will cache content for up to the time set in the <code v-pre>duration</code> field. If a longer cache duration is desired, it is recommended to invalidate the cache (see below) every time a QGIS project file
or any of the layers or their contents have changed.</p>
<doc-anchor-target id="cache-invalidation">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cache-invalidation">#</doc-anchor-trigger>
        <span>Cache invalidation</span>
    </h3>
</doc-anchor-target>
<p>Run the following command to invalidate the cache:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">%windir%\system32\inetsrv\appcmd recycle apppool /apppool.name:PoziQgisServer</code></pre>
</doc-codeblock></div>
<p>If the above does not clear the cache for any reason, then execute the following command instead (which will restart IIS):</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">iisreset</code></pre>
</doc-codeblock></div>
<p>These command can be added to a batch (.bat) file that the user can run. If administrator privileges are required, then, as administrator, create a shortcut
to this file and change its properties to get it to run as administrator.</p>
<p><strong>Note:</strong></p>
<p>IIS can choose to periodically clear the cache. This can happen within the space of minutes and it&#x27;s as of yet unclear how to prevent this from
happening.</p>
<doc-anchor-target id="background-information-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#background-information-1">#</doc-anchor-trigger>
        <span>Background information</span>
    </h3>
</doc-anchor-target>
<ul>
<li><a href="https://learn.microsoft.com/en-us/iis/manage/managing-performance-settings/configure-iis-7-output-caching#select-a-cache-policies">Configure IIS Output Caching</a></li>
</ul>
<doc-anchor-target id="enable-debugging-tracing">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#enable-debugging-tracing">#</doc-anchor-trigger>
        <span>Enable debugging (tracing)</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-gray-500 dark:bg-dark-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-gray-500 dark:text-dark-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Under Construction</h5>
<p><em>This section is a work in progress. Please get in touch with us before following any of the steps below</em></p>
        </div>
    </div>
</div>
<doc-anchor-target id="tracing">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#tracing">#</doc-anchor-trigger>
        <span>Tracing</span>
    </h3>
</doc-anchor-target>
<p>When requests fail or caching/compression does not work, it is recommended to use IIS&#x27;s tracing functionality to determine the cause if these issues.</p>
<p>First enable tracing for IIS:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">dism /online /Enable-Feature /FeatureName:IIS-HttpTracing</code></pre>
</doc-codeblock></div>
<p>Then, in the IIS manager, click on <code v-pre>Default Web Site</code> and in the <code v-pre>Actions</code> pane on the right hand side, click on <code v-pre>Failed Request Tracing...</code> under the <code v-pre>Configure</code> heading and then check <code v-pre>Enable</code> and close the window.</p>
<p>Then add the following to <code v-pre>C:\Pozi\IIS\QgisServer\web.config</code> to enable tracing for all requests in section <code v-pre>configuration.system.webServer</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\Pozi\IIS\QgisServer\web.config</div>
<pre class="language-markup"><code v-pre class="language-markup">        &lt;tracing&gt;
            &lt;traceFailedRequests&gt;
                &lt;add path=&quot;*&quot;&gt;
                    &lt;traceAreas&gt;
                        &lt;add provider=&quot;WWW Server&quot; areas=&quot;Authentication,Security,Filter,StaticFile,CGI,Compression,Cache,RequestNotifications,Module,FastCGI,WebSocket&quot; verbosity=&quot;Verbose&quot; /&gt;
                    &lt;/traceAreas&gt;
                    &lt;failureDefinitions statusCodes=&quot;3-999&quot; /&gt;
                &lt;/add&gt;
            &lt;/traceFailedRequests&gt;
        &lt;/tracing&gt;</code></pre>
</doc-codeblock></div>
<p>The tracing output files can generally be found in:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">%SystemDrive%\inetpub\logs\FailedReqLogFiles</code></pre>
</doc-codeblock></div>
<p>When opening the .xml file in Internet Explorer (!), the user gets presented with an interactive web page. The &#x27;Compact View&#x27; tab can provide useful information.</p>
<p>It is recommended to turn the feature off by commenting out the code block below when not needed any more.</p>
<p>Relevant events and some of their potential values are:</p>
<ul>
<li><code v-pre>OUTPUT_CACHE_LOOKUP_END</code>: <code v-pre>Result=&quot;FOUND&quot;</code>, <code v-pre>Result=&quot;NOT_FOUND&quot;</code>, <code v-pre>Result=&quot;CACHING_DISABLED&quot;</code></li>
</ul>
<p>More information about tracing failed requests can be found on <a href="https://learn.microsoft.com/en-us/iis/configuration/system.applicationhost/sites/site/tracefailedrequestslogging">Microsoft&#x27;s website</a>.</p>
<doc-anchor-target id="useful-commands">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#useful-commands">#</doc-anchor-trigger>
        <span>Useful commands</span>
    </h3>
</doc-anchor-target>
<p>The following PowerShell command provides a list of system events related to Pozi QGIS Server:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Get-WinEvent -LogName System | Where-Object {$_.Message -like &quot;*PoziQgisServer*&quot;} | out-host -paging</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="restart-iis--application-pool">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#restart-iis--application-pool">#</doc-anchor-trigger>
        <span>Restart IIS / Application Pool</span>
    </h2>
</doc-anchor-target>
<p>Restart IIS:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">iisreset /restart</code></pre>
</doc-codeblock></div>
<p>Restart Application pool:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">%windir%\system32\inetsrv\appcmd recycle apppool /apppool.name:PoziQgisServer</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="serving-static-files">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#serving-static-files">#</doc-anchor-trigger>
        <span>Serving Static Files</span>
    </h2>
</doc-anchor-target>
<p>Pozi can be configured to deliver documents and other content from your network to users within Pozi, either as clickable links or, if the link ends with <code v-pre>.jpg</code> or <code v-pre>.png</code>, as embedded images.</p>
<p>As a web application, Pozi can interact only through web URLs and not network file paths.</p>
<p>This section describes how to turn network folders into URLs that Pozi can use to access documents and image files.</p>
<doc-anchor-target id="create-parent-virtual-directory">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#create-parent-virtual-directory">#</doc-anchor-trigger>
        <span>Create Parent Virtual Directory</span>
    </h3>
</doc-anchor-target>
<p>Configure a top-level virtual folder within Pozi&#x27;s IIS profile as follows:</p>
<p>IIS &gt; select server &gt; Sites &gt; Default Web Site &gt; Pozi &gt; right-click &gt; Add Virtual Directory</p>
<ul>
<li>Alias: <code v-pre>static</code></li>
<li>Physical path: <code v-pre>C:\Pozi\IIS\Static</code></li>
<li>OK</li>
</ul>
<p>The path specified is not actually important, except if using it for directly storing content.</p>
<p>The purpose of this virtual directory is it creates a <code v-pre>/static</code> path within Pozi&#x27;s IIS endpoint under which one or more virtual subdirectories can be configured for various folders on your network.</p>
<doc-anchor-target id="create-subdirectories-for-your-content">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#create-subdirectories-for-your-content">#</doc-anchor-trigger>
        <span>Create Subdirectories for Your Content</span>
    </h3>
</doc-anchor-target>
<p>Create the virtual subdirectories within the new <code v-pre>/static</code> directory that can point to network folders containing your content.</p>
<p>IIS &gt; select server &gt; Sites &gt; Default Web Site &gt; Pozi &gt; <code v-pre>static</code> &gt; right-click &gt; Add Virtual Directory</p>
<ul>
<li>Alias: name of resource (eg <code v-pre>ConquestDocs</code>)</li>
<li>Physical path: path of network folder containing your content</li>
</ul>
<p>Note: the user account under which IIS application pool is running (typically PoziService or similar) must have read access to the physical path.</p>
<p><img src="../img/iis-virtual-directory.png" style="width:700px" alt="Alt text" /></p>
<doc-anchor-target id="links">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#links">#</doc-anchor-trigger>
        <span>Links</span>
    </h3>
</doc-anchor-target>
<p>When configured as above, any content within the specified folders can be accessed via their corresponding virtual directory.</p>
<doc-anchor-target id="example-file">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#example-file">#</doc-anchor-trigger>
        <span>Example File</span>
    </h4>
</doc-anchor-target>
<ul>
<li>Physical file: <code v-pre>\\&lt;networkdrive&gt;\GIS$\Documents\Cavendish\preschool.JPG</code></li>
</ul>
<doc-anchor-target id="example-links">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#example-links">#</doc-anchor-trigger>
        <span>Example Links</span>
    </h4>
</doc-anchor-target>
<ul>
<li>Local URL: <code v-pre>http://localhost/pozi/static/ConquestDocs/Cavendish/preschool.JPG</code></li>
<li>Network URL: <code v-pre>http://&lt;servername&gt;/pozi/static/ConquestDocs/Cavendish/preschool.JPG</code></li>
<li>Azure App Proxy URL: <code v-pre>https://&lt;appproxyendpoint&gt;/pozi/static/ConquestDocs/Cavendish/preschool.JPG</code></li>
</ul>
<p>The local and network URLs can be used for testing and troubleshooting purposes.</p>
<p>The Azure App Proxy URL is the link format you&#x27;ll use for referencing content within your layers.</p>
<br/>
<hr />
<doc-anchor-target id="proxy-ogr2ogr-from-iis">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#proxy-ogr2ogr-from-iis">#</doc-anchor-trigger>
        <span>Proxy ogr2ogr from IIS</span>
    </h2>
</doc-anchor-target>
<p>For clients with the legacy Pozi Server installed, but who are about to implement Azure AD integration, IIS can be configured to proxy requests to existing Pozi Server services (such as <code v-pre>ogr2ogr</code> required for Unified Search).</p>
<p>This enables IIS to be the default entry point for the Azure App Proxy whilst keeping access to Pozi Server&#x27;s <code v-pre>ogr2ogr</code> functionality.</p>
<p>Two pieces of software need to be installed with admin privileges and IIS needs to be configured manually (currently) to make the proxy functionality work.</p>
<doc-anchor-target id="instructions">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#instructions">#</doc-anchor-trigger>
        <span>Instructions</span>
    </h3>
</doc-anchor-target>
<ul>
<li>Download &amp; install x64 installer for <a href="https://www.iis.net/downloads/microsoft/url-rewrite">https://www.iis.net/downloads/microsoft/url-rewrite</a></li>
<li>Then download &amp; install x64 installer for <a href="https://www.iis.net/downloads/microsoft/application-request-routing">https://www.iis.net/downloads/microsoft/application-request-routing</a></li>
<li>Close and reopen IIS console</li>
</ul>
<doc-anchor-target id="in-iis-home">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#in-iis-home">#</doc-anchor-trigger>
        <span>In IIS Home</span>
    </h3>
</doc-anchor-target>
<ul>
<li>Open &#x27;Application Request Routing&#x27; icon</li>
<li>Click on Proxy - Server Proxy Settings</li>
<li>Check &#x27;Enable Proxy&#x27; and hit &#x27;Apply&#x27;</li>
</ul>
<p>Sites &gt; Default Web Site &gt; Pozi</p>
<ul>
<li>Open feature &#x27;URL rewrite&#x27;</li>
<li>&#x27;Add rules...&#x27; and double-click &#x27;Reverse Proxy&#x27;</li>
<li>Enter server name without http or https in &#x27;Inbound rules&#x27;. E.g., enter <code v-pre>local.pozi.com</code> if that is where PoziServer is running</li>
<li>OK</li>
<li>select newly created item, then Inbound Rules - Edit</li>
<li>Make sure that the values in the new rule match the attached image:</li>
<li><strong>Pattern</strong>: <code v-pre>^ogr2ogr(.*)</code></li>
<li><strong>Rewrite URL</strong>: <code v-pre>https://local.pozi.com/ogr2ogr{R:1}</code> (make sure to match the <code v-pre>http</code> or <code v-pre>https</code> of the original URL)</li>
<li>Apply</li>
<li>click Back</li>
<li>select ReverseProxyInboundR.. &gt; Rename: Pozi Server ogr2ogr</li>
</ul>
<p>Test: http://localhost/pozi/ogr2ogr</p>
<doc-anchor-target id="example-urls">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#example-urls">#</doc-anchor-trigger>
        <span>Example urls</span>
    </h3>
</doc-anchor-target>
<ul>
<li><a href="https://pozicloudserver-teampozi.msappproxy.net/pozi/ogr2ogr?source=sample/queenscliffe/delwp/vmfeat/foi_point.shp">https://pozicloudserver-teampozi.msappproxy.net/pozi/ogr2ogr?source=sample/queenscliffe/delwp/vmfeat/foi_point.shp</a></li>
</ul>
<doc-anchor-target id="iis-virtual-directory">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#iis-virtual-directory">#</doc-anchor-trigger>
        <span>IIS Virtual Directory</span>
    </h3>
</doc-anchor-target>
<p>This allows us to serve content from the file system</p>
<ul>
<li>Right click on Pozi (in Sites / Default Web Site)</li>
<li>Click on &#x27;Add Virtual Directory...&#x27;</li>
<li>Fill in the alias field, eg <code v-pre>static</code></li>
<li>Physical path: choose the path in the file system eg <code v-pre>C:\Pozi\IIS\Static</code></li>
<li>Hit OK</li>
</ul>
<hr />
<doc-anchor-target id="troubleshooting">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#troubleshooting">#</doc-anchor-trigger>
        <span>Troubleshooting</span>
    </h2>
</doc-anchor-target>
<doc-panels>
   <doc-panel id="ecw-layers-are-not-rendered" collapsed>
       <template #title>ECW layers are not rendered</template>
<p>Depending on how QGIS has been installed, some dependency paths may vary.</p>
<doc-anchor-target id="gdal_driver_path">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#gdal_driver_path">#</doc-anchor-trigger>
        <span><code v-pre>GDAL_DRIVER_PATH</code></span>
    </h4>
</doc-anchor-target>
<ul>
<li>GDAL 3.4 and earlier: <code v-pre>C:\OSGeo4W\bin\gdalplugins</code></li>
<li>GDAL 3.5: <code v-pre>C:\OSGeo4W\apps\gdal\lib\gdalplugins</code></li>
</ul>
<p>Update the <code v-pre>GDAL_DRIVER_PATH</code> environment variable accordingly.</p>
   </doc-panel>
   <doc-panel id="qgis-desktop-doesn-t-open" collapsed>
       <template #title>QGIS Desktop doesn&#x27;t open</template>
<p>If you experience an &quot;Error loading QGIS&quot; message, it may specify a file named <code v-pre>qgis-ltr-bin.env</code> that might not exist in your installation:</p>
<blockquote>
<p>Error loading QGIS
Oops, looks like an error loading QGIS</p>
<p>Details:
Could not load qgis_app.dll
Windows Error: The specified module could not be found.</p>
<p>Help:
Check C:\OSGeo4W\bin\qgis-ltr-bin.env for correct environment paths</p>
</blockquote>
<p>Use a text editor to recreate the missing file with the following content:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">C:\OSGeo4W\bin\qgis-ltr-bin.env</div>
<pre class="language-batch"><code v-pre class="language-batch">PATH=C:\OSGeo4W\apps\qgis-ltr\bin;C:\OSGeo4W\apps\qt5\bin;C:\OSGeo4W\apps\Python312\Scripts;C:\OSGeo4W\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32\WBem
GDAL_DATA=C:\OSGeo4W\apps\gdal\share\gdal
GDAL_DRIVER_PATH=C:\OSGeo4W\apps\gdal\lib\gdalplugins
GDAL_FILENAME_IS_UTF8=YES
JPEGMEM=1000000
OSGEO4W_ROOT=C:\OSGeo4W
PROJ_LIB=C:\OSGeo4W\share\proj
PYTHONHOME=C:\OSGeo4W\apps\Python312
PYTHONUTF8=1
QGIS_PREFIX_PATH=C:/OSGeo4W/apps/qgis-ltr
QT_PLUGIN_PATH=C:\OSGeo4W\apps\qgis-ltr\qtplugins;C:\OSGeo4W\apps\qt5\plugins
VSI_CACHE=TRUE
VSI_CACHE_SIZE=1000000
O4W_QT_PREFIX=C:/OSGeo4W/apps/Qt5
O4W_QT_BINARIES=C:/OSGeo4W/apps/Qt5/bin
O4W_QT_PLUGINS=C:/OSGeo4W/apps/Qt5/plugins
O4W_QT_LIBRARIES=C:/OSGeo4W/apps/Qt5/lib
O4W_QT_TRANSLATIONS=C:/OSGeo4W/apps/Qt5/translations
O4W_QT_HEADERS=C:/OSGeo4W/apps/Qt5/include
QGIS_WIN_APP_NAME=OSGeo4W\QGIS Desktop 3.22.8</code></pre>
</doc-codeblock></div>
<p>Check that the <code v-pre>GDAL_DATA</code> and <code v-pre>GDAL_DRIVER_PATH</code> paths exist for your installation. If not, update the file accordingly.</p>
<p>If you are denied permission to create or edit the file in the destination location, create the file elsewhere and move it to <code v-pre>C:\OSGeo4W\bin\</code> using Windows Explorer.</p>
<p><a href="https://github.com/qgis/QGIS/issues/49148#issuecomment-1174459434">Further details about this issue</a></p>
   </doc-panel>
   <doc-panel id="iis-seems-to-go-to-sleep" collapsed>
       <template #title>IIS seems to &quot;go to sleep&quot;</template>
<p>IIS &gt; select server &gt; Application Pools &gt; PoziQgisServer &gt; Advanced Settings:</p>
<ul>
<li>General &gt; Start Mode &gt; <code v-pre>AlwaysRunning</code></li>
<li>Process Model &gt; Idle Time-out (minutes) &gt; <code v-pre>0</code></li>
<li>Recycling &gt; Regular Time Interval (minutes) &gt; <code v-pre>0</code></li>
</ul>
   </doc-panel>
   <doc-panel id="layers-that-are-visible-in-qgis-appear-as-blank-empty-layers-in-pozi" collapsed>
       <template #title>Layers that are visible in QGIS appear as blank/empty layers in Pozi</template>
<p>Check that the domain account that is running the IIS application pool (eg PoziService) has the necessary permissions to access the layer source.</p>
<p>Check whether the service account has the right permissions by running QGIS as the service account user. Hold Shift and right-click on the QGIS desktop shortcut, choose &#x27;Run as a different user&#x27;, then enter the credentials of the service account. Open the QGIS project to which the affected layer(s) belong and check whether you can view the layer.</p>
<p>If the layer(s) are visible in QGIS but still not in Pozi, try updating the following IIS setting:</p>
<p>IIS &gt; Your Server &gt; Application Pools &gt; PoziQgisServer &gt; Advanced Settings &gt; Load User Profile &gt; set to <code v-pre>True</code>.</p>
<p>Recycle the PoziQgisServer application pool and reload Pozi.</p>
   </doc-panel>
   <doc-panel id="qgis-project-layer-group-is-visible-but-can-t-be-expanded" collapsed>
       <template #title>QGIS project layer group is visible but can&#x27;t be expanded</template>
<p>On loading the error message &quot;Something went wrong: layer may be misconfigured. Layer: &#x27;[Your QGIS project layer]&#x27;, type: &#x27;QGISProjectSettings&#x27;&quot; appears.</p>
<p>If the layer group for the QGIS project is visible, but cannot be expanded to show the layers within the project, this may be due to a CORS (cross-origin resource sharing) issue.</p>
<p>Visit the <doc-anchor-trigger to="#cors">CORS</doc-anchor-trigger> section above to set the appropriate CORS settings.</p>
   </doc-panel>
   <doc-panel id="http-error-403-14-forbidden" collapsed>
       <template #title>HTTP Error 403.14 Forbidden</template>
<p>This is likely due to the browser visiting <code v-pre>http://localhost/pozi/</code> instead of <code v-pre>http://localhost/pozi/qgisserver</code>.</p>
<p>This is expected behaviour when IIS has not been configured to serve static files from <code v-pre>http://localhost/pozi/</code> (which is the default).</p>
<p>Solution: visit <code v-pre>http://localhost/pozi/qgisserver/wfs3.html</code> for testing instead</p>
   </doc-panel>
   <doc-panel id="service-unavailable-http-error-503" collapsed>
       <template #title>Service Unavailable. HTTP Error 503</template>
<p>If this happens when visiting <code v-pre>http://localhost/pozi/qgisserver/wfs3.html</code> for example, it could be that the QGIS Server application pool in IIS is not running.</p>
<p>Solution: in the IIS Manager, check if the <code v-pre>PoziQgisServer</code> application pool is running. If not, start it and refresh the page.</p>
<p>It may be worth finding what would have caused it not to run.</p>
   </doc-panel>
</doc-panels>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results />
                            </div>
                            <footer class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-blue-500 dark:text-blue-400 hover:text-blue-700 hover:underline" href="https://github.com/pozi/PoziWebsite/blob/main/admin-guide/installation/iis.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../admin-guide/installation/qgis-server/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">QGIS Server</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../admin-guide/installation/entra-id/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Entra ID</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="about">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <path d="M6.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM5.5 9.25a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM6.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 12.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zm.75-4.25a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM9 5.75A.75.75 0 019.75 5h.5a.75.75 0 010 1.5h-.5A.75.75 0 019 5.75zM13.25 12a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zm-.75-2.75a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5a.75.75 0 01-.75-.75zM13.25 5a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5z"/><path fill-rule="evenodd" d="M2 20a2 2 0 002 2h3.75a.75.75 0 00.75-.75V19h3v2.25c0 .414.336.75.75.75H16c.092 0 .183-.006.272-.018a.753.753 0 00.166.018H20a2 2 0 002-2v-8a2 2 0 00-.8-1.6l-.5-.375a.75.75 0 00-.9 1.2l.5.375a.5.5 0 01.2.4v8a.5.5 0 01-.5.5h-2.063c.041-.16.063-.327.063-.5V3a2 2 0 00-2-2H4a2 2 0 00-2 2v17zm2 .5a.5.5 0 01-.5-.5V3a.5.5 0 01.5-.5h12a.5.5 0 01.5.5v17a.5.5 0 01-.5.5h-3v-2.25a.75.75 0 00-.75-.75h-4.5a.75.75 0 00-.75.75v2.25H4z"/>
                                                    </g>
                                                </svg>
                                                <span>About</span>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="contact">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <path fill-rule="evenodd" d="M20.226 7.25a9.498 9.498 0 10-3.477 12.976.75.75 0 01.75 1.299c-5.26 3.037-11.987 1.235-15.024-4.026C-.562 12.24 1.24 5.512 6.501 2.475 11.76-.562 18.488 1.24 21.525 6.501a10.956 10.956 0 011.455 4.826c.013.056.02.113.02.173v2.25a3.5 3.5 0 01-6.623 1.581 5.5 5.5 0 111.112-3.682.76.76 0 01.011.129v1.972a2 2 0 104 0v-1.766a9.452 9.452 0 00-1.274-4.733zM16 12a4 4 0 10-8 0 4 4 0 008 0z"/>
                                                    </g>
                                                </svg>
                                                <span>Contact</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024 - Pozi Pty Ltd</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script>window.__DOCS__ = { "title": "IIS", level: 3, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
</body>
</html>
